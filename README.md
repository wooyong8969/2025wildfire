# ğŸ”¥ ì‚°ë¶ˆ í™•ì‚° ì˜ˆì¸¡ íƒêµ¬ (Wildfire Spread Prediction)

> ë³¸ í”„ë¡œì íŠ¸ëŠ” **ì¶©ë¶ê³¼í•™ê³ ë“±í•™êµ**ì˜ **ã€Œ2025 ì œ 2íšŒ ìœµí•©íƒêµ¬ 321ì²´ã€**ì— ì°¸ì—¬í•œ  
> **ì½”íŒ…"ì¢Œ" íŒ€**ì´ ìˆ˜í–‰í•œ **êµë‚´ ìœµí•©íƒêµ¬ í”„ë¡œì íŠ¸**ì…ë‹ˆë‹¤.



## ğŸ“Œ íƒêµ¬ ê°œìš”

ì‚°ë¶ˆì€ ì˜ˆì¸¡ì´ ì–´ë µê³  ë¹ ë¥´ê²Œ í™•ì‚°ë˜ì–´ ìƒëª…ê³¼ ì¬ì‚°ì— í° í”¼í•´ë¥¼ ì¤ë‹ˆë‹¤. ë³¸ íƒêµ¬ëŠ”  
ìœ„ì„± ì˜ìƒê³¼ ê¸°ìƒ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ **AI ëª¨ë¸ì´ ì‚°ë¶ˆ í™•ì‚° ìœ„ì¹˜ë¥¼ ì˜ˆì¸¡**í•  ìˆ˜ ìˆë„ë¡  
ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•˜ê³ , segmentation ëª¨ë¸ì„ í•™ìŠµ ë° í‰ê°€í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.


## ğŸ“¦ 1. ë°ì´í„°ì…‹ êµ¬ì¶• ê³¼ì • (Dataset Construction)

### ğŸ”¨ ë‹¨ê³„ë³„ ì²˜ë¦¬ íë¦„

| ë‹¨ê³„ | ë‚´ìš© | ê´€ë ¨ ì½”ë“œ |
|------|------|-----------|
| 1 | NASA FIRMS ìœ„ì„± ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, 15km x 15km ê²©ì ë‹¨ìœ„ ì‚°ë¶ˆ ë§ˆìŠ¤í¬(`today_firemask`) ì´ë¯¸ì§€ ìƒì„± | `1_make_only_firedata.py` |
| 2 | ë‚ ì§œë³„ ë©”íƒ€ë°ì´í„° í†µí•© ë° ì „ë‚  ë§ˆìŠ¤í¬(`prev_firemask`) ë§¤í•‘ | `2_merge_firemask.py` |
| 3 | ì‚°ë¶ˆì´ ì „ë‚  ìˆì—ˆë˜ ê²½ìš°ë§Œ í•„í„°ë§ â†’ â€œì‚°ë¶ˆ í™•ì‚°â€ ì¼€ì´ìŠ¤ë¡œ ì œí•œ | `3_filtering_firemask.py` |
| 4 | MODIS ê¸°ë°˜ NDVI, EVI, ë°˜ì‚¬ìœ¨(red/nir/blue) ë°ì´í„° ë³‘í•© | `4_merge_modis.py` |
| 5 | í’í–¥/í’ì† ì •ë³´(ê¸°ìƒì²­ wind ìœ„ì„±ìë£Œ) ë³‘í•© | `5_merge_wind.py` |
| 6 | ê¸°ìƒì²­ ê´€ì¸¡ì†Œ ê¸°ì˜¨/ê°•ìˆ˜/ìŠµë„ ë° ê³ ë„ ì •ë³´ ë³‘í•© | `6_merge_weather.py` |
| 7 | NDVI/EVI ê²°ì¸¡ì¹˜ ë³´ê°„ ì²˜ë¦¬ (Â±2ì¼ ì´ë‚´ ì¸ì ‘ ê²©ì ê¸°ë°˜) | `7_fill_NaN.py` |

ìµœì¢… ë°ì´í„°ëŠ” `firemask_modis_wind_weather_end_2day.csv`ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

### ğŸ—‚ï¸ ìµœì¢… ë°ì´í„° êµ¬ì„± (CSV Columns)

| ì—´ ì´ë¦„ | ì„¤ëª… |
|---------|------|
| `date` | í•´ë‹¹ ì¼ì |
| `lat_min`, `lat_max` | ê²©ìì˜ ìœ„ë„ ë²”ìœ„ |
| `lon_min`, `lon_max` | ê²©ìì˜ ê²½ë„ ë²”ìœ„ |
| `prev_fire_point` | ì „ë‚  í™”ì¬ ê°ì§€ ì  ìˆ˜ |
| `today_point_count` | ë‹¹ì¼ í™”ì¬ ê°ì§€ ì  ìˆ˜ |
| `prev_frp_mean` | ì „ë‚  ë³µì‚¬í™”ë ¥(FRP) í‰ê·  |
| `today_frp_mean` | ë‹¹ì¼ ë³µì‚¬í™”ë ¥ í‰ê·  |
| `prev_firemask` | ì „ë‚  í™”ì¬ ë§ˆìŠ¤í¬ ì´ë¯¸ì§€ ê²½ë¡œ |
| `today_firemask` | ë‹¹ì¼ í™”ì¬ ë§ˆìŠ¤í¬ ì´ë¯¸ì§€ ê²½ë¡œ (ì˜ˆì¸¡ ëŒ€ìƒ) |
| `NDVI`, `EVI` | ì‹ìƒ ì§€ìˆ˜ |
| `surf_reflectance_red`, `nir`, `blue` | í‘œë©´ ë°˜ì‚¬ìœ¨ |
| `wind_dir`, `wind_speed` | í’í–¥, í’ì† |
| `stn_id` | ê¸°ìƒ ê´€ì¸¡ì†Œ ID |
| `TA_AVG`, `TA_MAX`, `TA_MIN` | í‰ê· , ìµœê³ , ìµœì € ê¸°ì˜¨ |
| `HM_AVG` | í‰ê·  ìŠµë„ |
| `RN_DAY` | ì¼ì¼ ê°•ìˆ˜ëŸ‰ |
| `altitude` | ê³ ë„ (ê´€ì¸¡ì†Œ ê¸°ì¤€) |

> ğŸ” `prev_firemask`, `today_firemask`ëŠ” ì‹¤ì œ ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œì´ë©°, ëª¨ë¸ í•™ìŠµ ì‹œ ì§ì ‘ ë¶ˆëŸ¬ì˜¤ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.



## ğŸ§  2. ëª¨ë¸ í•™ìŠµ ë° ì˜ˆì¸¡ (Model Training & Prediction)

### ğŸ§© ëª¨ë¸ êµ¬ì¡°

- ì…ë ¥:
  - ì´ë¯¸ì§€: `prev_firemask` (1Ã—150Ã—150)
  - ìˆ˜ì¹˜ ë°ì´í„°: ì´ 15ê°œ feature
- ì•„í‚¤í…ì²˜:
  - CNN encoder + MLP encoder â†’ U-Net style decoder
- ì¶œë ¥:
  - ì˜ˆì¸¡ ë§ˆìŠ¤í¬ `today_firemask` (binary segmentation)

ëª¨ë¸ êµ¬ì¡°ëŠ” `MultiModalUNet`ìœ¼ë¡œ ì •ì˜ë˜ì–´ ìˆìœ¼ë©°, CNNê³¼ MLPì˜ ì¶œë ¥ íŠ¹ì„±ì„ ë³‘í•©í•˜ì—¬ ë³µì›í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

### ğŸ“š í•™ìŠµ ë°©ë²•

- ì†ì‹¤ í•¨ìˆ˜: `BCEWithLogitsLoss`
- Optimizer: `Adam`
- Epochs: 20
- Batch size: 8


â†’ í•™ìŠµ ì™„ë£Œ í›„ `firemask_model.pth`ë¡œ ëª¨ë¸ ì €ì¥

### ğŸ” ì˜ˆì¸¡ ë° ì‹œê°í™”

íŒŒì¼: `11_predict_data.py`

- íŠ¹ì • í–‰ ì„ íƒí•˜ì—¬ ì˜ˆì¸¡ ë§ˆìŠ¤í¬ ìƒì„±
- ì‹¤ì œ ë§ˆìŠ¤í¬ì™€ ë¹„êµí•˜ì—¬ IoU, Dice Score ì‚°ì¶œ
- ì‹œê°í™” ì¶œë ¥ (ì…ë ¥ / ì˜ˆì¸¡ / ì •ë‹µ ë§ˆìŠ¤í¬ ë¹„êµ)



## ğŸ–¼ï¸ ì˜ˆì¸¡ ê²°ê³¼ ì˜ˆì‹œ (Visualization Examples)

ì•„ë˜ëŠ” ëª¨ë¸ì´ ì „ë‚  í™”ì¬ ë§ˆìŠ¤í¬ì™€ ê¸°ìƒ ì •ë³´ë¥¼ ì…ë ¥ë°›ì•„, ë‹¹ì¼ ì‚°ë¶ˆ ë§ˆìŠ¤í¬ë¥¼ ì˜ˆì¸¡í•œ ê²°ê³¼ì…ë‹ˆë‹¤.



## ğŸ“‚ í´ë” êµ¬ì¡°

```
2025WILDFIRE/
â”œâ”€â”€ CODE/
â”‚   â”œâ”€â”€ 1_make_only_firedata.py
â”‚   â”œâ”€â”€ 2_merge_firemask.py
â”‚   â”œâ”€â”€ 3_filtering_firemask.py
â”‚   â”œâ”€â”€ 4_merge_modis.py
â”‚   â”œâ”€â”€ 5_merge_wind.py
â”‚   â”œâ”€â”€ 6_merge_weather.py
â”‚   â”œâ”€â”€ 7_fill_NaN.py
â”‚   â”œâ”€â”€ 8_check_NaN.py
â”‚   â”œâ”€â”€ 9_check_white.py
â”‚   â”œâ”€â”€ 10_firemask_segmentation.py   â† ëª¨ë¸ í•™ìŠµ ì½”ë“œ
â”‚   â”œâ”€â”€ 11_predict_data.py            â† ì˜ˆì¸¡ ë° ì‹œê°í™”
â”‚   â””â”€â”€ firemask_segmentation.py      â† (10ë²ˆ ì½”ë“œì™€ ë™ì¼)
â”‚
â”œâ”€â”€ firemask_output/                 â† ìƒì„±ëœ ë§ˆìŠ¤í¬ ì´ë¯¸ì§€
â”‚
â”œâ”€â”€ firemask_model.pth               â† í•™ìŠµëœ ëª¨ë¸ ê°€ì¤‘ì¹˜
â””â”€â”€ firemask_modis_wind_weather_end_2day.csv â† ìµœì¢… ë°ì´í„°ì…‹

```



## ğŸ“š ì°¸ê³  ìë£Œ

- NASA FIRMS: https://firms.modaps.eosdis.nasa.gov/
- MODIS Vegetation Indices: https://noaa-cdr-ndvi-pds.s3.amazonaws.com/index.html#data/
- ê¸°ìƒì²­ ë‚ ì”¨ ë° ê´€ì¸¡ì†Œ ë°ì´í„° https://data.kma.go.kr/data/grnd/selectAsosRltmList.do